# 员工身份类别导出脚本使用说明

## 功能描述
该脚本用于导出指定薪资周期的所有员工身份类别信息到CSV文件。

## 安装依赖
```bash
pip install psycopg2-binary
```

## 使用方法

### 1. 基本用法
```bash
# 导出2025年6月的员工信息
python export_employee_categories.py 2025-06
```

### 2. 指定输出文件
```bash
# 自定义输出文件名
python export_employee_categories.py 2025-06 --output 员工信息_202506.csv
```

### 3. 仅查看统计信息
```bash
# 只显示统计信息，不导出文件
python export_employee_categories.py 2025-06 --stats-only
```

### 4. 查看帮助
```bash
python export_employee_categories.py --help
```

## 输出文件包含字段

| 字段名 | 描述 |
|--------|------|
| 薪资周期 | 薪资发放周期名称 |
| 周期开始日期 | 薪资周期开始日期 |
| 周期结束日期 | 薪资周期结束日期 |
| 发放日期 | 薪资发放日期 |
| 员工编号 | 员工工号 |
| 员工姓名 | 员工姓名 |
| 身份证号 | 员工身份证号码 |
| 人员类别名称 | 身份类别（如：公务员、事业管理人员等） |
| 人员类别编码 | 类别编码 |
| 人员类别描述 | 类别详细描述 |
| 部门名称 | 所属部门 |
| 职位名称 | 职位名称 |
| 入职日期 | 入职时间 |
| 员工状态 | 在职/离职状态 |
| 应发合计 | 应发工资总额 |
| 扣除合计 | 扣除金额总计 |
| 实发合计 | 实际发放金额 |
| 计算时间 | 薪资计算时间 |

## 输出示例

脚本运行后会显示统计信息：
```
=== 2025年06月 员工类别统计 ===
周期时间: 2025-05-31 至 2025-06-29
发放日期: 2025-07-04

人员类别分布:
------------------------------------------------------------
公务员           |  32人 | 平均应发: 18562.34 | 平均实发: 13245.67
参照公务员管理   |  28人 | 平均应发: 16875.21 | 平均实发: 11923.45
事业管理人员     |   8人 | 平均应发: 12456.78 | 平均实发:  9234.56
综合类           |  10人 | 平均应发:  7234.56 | 平均实发:  5234.67
机关工勤         |   3人 | 平均应发: 14567.89 | 平均实发: 10123.45
------------------------------------------------------------
总计             |  81人

成功导出 81 条员工记录到: 员工身份类别_2025-06_20250124_143025.csv
```

## 注意事项

1. 确保网络能够连接到数据库服务器
2. 薪资周期格式必须为 `YYYY-MM`（如：2025-06）
3. 输出的CSV文件使用UTF-8编码，可以用Excel正确打开
4. 如果指定的薪资周期不存在，脚本会提示错误信息

## 常见问题

### Q: 出现数据库连接错误怎么办？
A: 检查网络连接和数据库服务器状态，确保能够访问 8.137.160.207:5432

### Q: 找不到指定的薪资周期怎么办？
A: 确认输入的周期格式正确，并且该周期在系统中存在薪资数据

### Q: CSV文件中文显示乱码怎么办？
A: 脚本使用UTF-8-BOM编码，Excel应该能正确显示中文。如仍有问题，可以用其他编辑器打开。