-- 批量更新员工性别数据
-- 从PGS数据库导入的正确性别信息

-- 基于姓名更新性别（适用于姓名唯一的情况）
UPDATE employees SET gender = '女'::employee_gender_enum WHERE full_name IN ('伍宇星', '何婷', '刘丹', '刘嘉', '包晓静', '卢妍如', '周雪莲', '宋方圆', '廖希', '张玲', '张秋子', '张练', '徐颖', '方敬玉', '曹钰佼', '李佳', '李子贤', '李文媛', '李薇', '杜疆', '杨也', '杨勤文', '杨洋', '杨钰婕', '殷凌霄', '江慧', '汪倩', '汪琳', '沈丽萍', '熊静', '田原', '符译文', '罗蓉', '胡潇', '蒋文韬', '蒲薇', '谢欣然', '赖梅', '赵霁梅', '邱高长青', '郑偲', '阴琪', '陈敏', '陈琳', '陈秋如', '韩霜', '马霜', '高洪艳', '黄卓尔', '黄明');

UPDATE employees SET gender = '男'::employee_gender_enum WHERE full_name IN ('何万达', '余浩川', '冉光俊', '卢泓良', '吕果', '周宏伟', '周湜杰', '周至涯', '唐国晋', '张净', '张晋维', '张磊', '张福祥', '徐云祥', '徐明扬', '李庆', '李旻', '李汶卿', '李洋洋', '李润民', '杨圣', '沙砾', '王优', '申龙', '罗先华', '罗茗文', '胡艺山', '谷颖', '辛文', '鄢银', '阙兮遥', '阮永强');

-- 基于身份证号更新（更准确）
UPDATE employees e
SET gender = CASE 
    WHEN t.gender = '男' THEN '男'::employee_gender_enum
    WHEN t.gender = '女' THEN '女'::employee_gender_enum
END
FROM (VALUES
    ('510105199305021047', '女'),
    ('513721199708058376', '男'),
    ('510102197110271064', '女'),
    ('513433198901200033', '男'),
    ('510103197309155710', '男'),
    ('513101198306270320', '女'),
    ('51010419790927236X', '女'),
    ('51010719800901262X', '女'),
    ('51162219951030004X', '女'),
    ('371311198812263436', '男'),
    ('510107197509030897', '男'),
    ('429006198705292113', '男'),
    ('510104198001113478', '男'),
    ('511081198010240012', '男'),
    ('511323198111206326', '女'),
    ('511381199708288596', '男'),
    ('510321198809260048', '女'),
    ('510113198101150029', '女'),
    ('511302198809010737', '男'),
    ('522401199203170214', '男'),
    ('510124197803210027', '女'),
    ('511111198901171715', '男'),
    ('230621199504160058', '男'),
    ('513022199309130025', '女'),
    ('511527198411210024', '女'),
    ('510122197604122873', '男'),
    ('510322198312070042', '女'),
    ('510102196903083202', '女'),
    ('51072219930820784X', '女'),
    ('511381199005110265', '女'),
    ('13022719980123102X', '女'),
    ('510107197706032170', '男'),
    ('370902197908020026', '女'),
    ('142601197807242814', '男'),
    ('620503199907198039', '男'),
    ('130702198807161216', '男'),
    ('511723199812279452', '男'),
    ('510212197210121627', '女'),
    ('510105197804032526', '女'),
    ('513902199405034969', '女'),
    ('510104198207264060', '女'),
    ('51032119921205801X', '男'),
    ('510106197512164128', '女'),
    ('511102199707145925', '女'),
    ('513101198908076023', '女'),
    ('513823198406075828', '女'),
    ('622425199903206622', '女'),
    ('510103197108310040', '女'),
    ('512501197304092141', '女'),
    ('510107198806212632', '男'),
    ('510102197005034083', '女'),
    ('511522199501270031', '男'),
    ('513030199904070047', '女'),
    ('510726198801255811', '男'),
    ('513001199604011027', '女'),
    ('510125197310025831', '男'),
    ('513723197908210014', '男'),
    ('510106197511143528', '女'),
    ('511113199412223323', '女'),
    ('510522198903201295', '男'),
    ('511321199906230129', '女'),
    ('510104198105140665', '女'),
    ('510902198205169343', '女'),
    ('512528197506224093', '男'),
    ('510103197305160707', '女'),
    ('510105198512060263', '女'),
    ('220211198706221217', '男'),
    ('511524199204180024', '女'),
    ('510108198811022127', '女'),
    ('513902198504212172', '男'),
    ('510403199303170712', '男'),
    ('510103197106306216', '男'),
    ('650300197206205423', '女'),
    ('510104198109290281', '女'),
    ('510403197704302625', '女'),
    ('51150219950729002X', '女'),
    ('511002197402181525', '女'),
    ('511302198612070349', '女'),
    ('510103197106094225', '女'),
    ('513101199605060045', '女'),
    ('513401196804180245', '女')
) AS t(id_number, gender)
WHERE e.id_number_encrypted = t.id_number;

-- 查看更新结果
SELECT gender, COUNT(*) as count 
FROM employees 
GROUP BY gender 
ORDER BY gender;