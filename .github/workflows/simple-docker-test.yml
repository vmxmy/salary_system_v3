name: Simple Docker Login Test

on:
  workflow_dispatch:

jobs:
  simple-docker-test:
    name: Simple Docker Hub Login Test
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    # 最简单的 Docker Hub 登录配置
    - name: Login to Docker Hub (Simple)
      uses: docker/login-action@v3
      with:
        username: ${{ secrets.DOCKER_USERNAME }}
        password: ${{ secrets.DOCKER_PASSWORD }}
        
    - name: Test login success
      run: |
        echo "✅ Docker Hub 登录成功!"
        docker info
        
    - name: Test with recommended configuration
      uses: docker/login-action@v3
      with:
        username: ${{ vars.DOCKERHUB_USERNAME }}
        password: ${{ secrets.DOCKERHUB_TOKEN }}
      continue-on-error: true
      
    - name: Show available configurations
      run: |
        echo "🔧 可用配置检查:"
        echo "DOCKER_USERNAME secret: $(if [ -n '${{ secrets.DOCKER_USERNAME }}' ]; then echo '已设置'; else echo '未设置'; fi)"
        echo "DOCKER_PASSWORD secret: $(if [ -n '${{ secrets.DOCKER_PASSWORD }}' ]; then echo '已设置'; else echo '未设置'; fi)"
        echo "DOCKERHUB_USERNAME variable: $(if [ -n '${{ vars.DOCKERHUB_USERNAME }}' ]; then echo '已设置'; else echo '未设置'; fi)"
        echo "DOCKERHUB_TOKEN secret: $(if [ -n '${{ secrets.DOCKERHUB_TOKEN }}' ]; then echo '已设置'; else echo '未设置'; fi)"