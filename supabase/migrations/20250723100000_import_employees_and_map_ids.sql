-- 准备一个临时表来存储员工数据和新生成的UUID
CREATE TEMPORARY TABLE temp_employee_import (
    old_id BIGINT,
    new_id UUID DEFAULT gen_random_uuid(),
    full_name VARCHAR(100),
    id_number TEXT,
    gender TEXT,
    date_of_birth DATE,
    hire_date DATE
);

-- 插入从原系统查询到的数据 (已处理)
INSERT INTO temp_employee_import (old_id, full_name, id_number, gender, date_of_birth, hire_date) VALUES
(332, '李洋洋', '130702198807161216', '男', '1988-07-15', '2010-07-01'),
(328, '符译文', '513001199604011027', '女', '1996-04-01', '2022-07-29'),
(334, '李润民', '511723199812279452', '男', '1998-12-27', '2022-07-29'),
(348, '殷凌霄', '513101198908076023', '女', '1989-08-07', '2014-07-01'),
(347, '李子贤', '13022719980123102X', '女', '1998-01-23', '2023-07-14'),
(367, '鄢银', '513902198504212172', '男', NULL, '2007-07-01'),
(368, '张晋维', '522401199203170214', '男', NULL, '2018-05-01'),
(369, '汪倩', '622425199903206622', '女', NULL, '2020-08-01'),
(365, '赵霁梅', '510105198512060263', '女', NULL, '2008-07-01'),
(366, '阙兮遥', '510403199303170712', '男', NULL, '2016-08-01'),
(370, '辛文', '220211198706221217', '男', NULL, '2010-01-01'),
(371, '蒋文韬', '511321199906230129', '女', NULL, '2022-07-01'),
(362, '黄卓尔', '513101199605060045', '女', NULL, '2018-11-01'),
(353, '周至涯', '511081198010240012', '男', '1980-10-23', '1999-08-31'),
(358, '江慧', '513823198406075828', '女', NULL, '2006-07-01'),
(337, '伍宇星', '510105199305021047', '女', '1993-04-29', '2018-07-10'),
(361, '宋方圆', '510321198809260048', '女', NULL, '2010-01-01'),
(351, '张秋子', '513022199309130025', '女', '1993-09-13', '2017-07-01'),
(359, '谢欣然', '510902198205169343', '女', NULL, '2004-08-01'),
(349, '何万达', '513721199708058376', '男', '1997-08-05', '2021-07-20'),
(354, '阮永强', '510103197106306216', '男', NULL, '1990-10-01'),
(352, '申龙', '510726198801255811', '男', '1988-01-25', '2012-08-01'),
(356, '陈敏', '510104198109290281', '女', NULL, '2001-07-01'),
(350, '沙砾', '510107198806212632', '男', '1988-06-21', '2013-05-01'),
(360, '周湜杰', '510104198001113478', '男', NULL, '2005-06-01'),
(357, '徐云祥', '510122197604122873', '男', NULL, '1996-08-01'),
(355, '徐颖', '510322198312070042', '女', NULL, '2007-07-01'),
(363, '李佳', '511381199005110265', '女', NULL, '2013-09-01'),
(364, '卢妍如', '51162219951030004X', '女', NULL, '2017-01-01'),
(310, '罗先华', '510125197310025831', '男', '1973-10-02', '1992-08-01'),
(318, '包晓静', '51010719800901262X', '女', '1980-09-01', '1999-07-01'),
(312, '方敬玉', '510102196903083202', '女', '1969-03-08', '1990-07-01'),
(313, '高洪艳', '510103197106094225', '女', '1971-06-09', '1991-08-01'),
(374, '李旻', '142601197807242814', '男', NULL, '2001-07-01'),
(304, '韩霜', '511002197402181525', '女', '1974-02-18', '1995-09-01'),
(373, '陈琳', '510403197704302625', '女', NULL, '2007-09-01'),
(316, '何婷', '510102197110271064', '女', '1971-10-27', '1991-04-01'),
(308, '黄明', '513401196804180245', '女', '1968-04-18', '1990-08-01'),
(305, '李薇', '510212197210121627', '女', '1972-10-12', '1995-07-01'),
(319, '李文媛', '370902197908020026', '女', '1979-08-02', '2001-10-01'),
(317, '廖希', '510113198101150029', '女', '1981-01-15', '2003-07-01'),
(320, '刘丹', '513101198306270320', '女', '1983-06-27', '2005-07-01'),
(314, '罗蓉', '510106197511143528', '女', '1975-11-14', '1995-02-01'),
(383, '杨圣', '51032119921205801X', '男', NULL, '2018-07-01'),
(381, '郑偲', '510108198811022127', '女', NULL, '2011-09-01'),
(380, '张练', '511527198411210024', '女', NULL, '2006-07-01'),
(382, '张净', '511302198809010737', '男', NULL, '2013-06-01'),
(379, '阴琪', '650300197206205423', '女', NULL, '1997-07-01'),
(377, '张玲', '510124197803210027', '女', NULL, '1998-07-01'),
(376, '杜疆', '510105197804032526', '女', NULL, '1998-09-01'),
(375, '杨勤文', '510104198207264060', '女', NULL, '1999-11-01'),
(378, '赖梅', '510103197305160707', '女', NULL, '1992-09-01'),
(372, '沈丽萍', '512501197304092141', '女', NULL, '1993-01-01'),
(333, '罗茗文', '513723197908210014', '男', '1979-08-21', '2003-07-01'),
(338, '卢泓良', '371311198812263436', '男', '1988-12-26', '2017-07-01'),
(330, '杨也', '513902199405034969', '女', '1994-05-03', '2020-07-01'),
(336, '曹钰佼', '51072219930820784X', '女', '1993-08-20', '2019-07-17'),
(331, '王优', '511522199501270031', '男', '1995-01-27', '2020-07-01'),
(335, '余浩川', '513433198901200033', '男', '1989-01-20', '2012-09-01'),
(329, '陈秋如', '51150219950729002X', '女', '1995-07-29', '2020-07-01'),
(325, '谷颖', '512528197506224093', '男', '1975-06-22', '1995-07-01'),
(326, '胡潇', '511113199412223323', '女', '1994-12-22', '2018-10-01'),
(307, '吕果', '510107197509030897', '男', '1975-09-03', '1997-12-01'),
(321, '马霜', '511302198612070349', '女', '1986-12-07', '2012-07-01'),
(306, '蒲薇', '510104198105140665', '女', '1981-05-14', '2003-07-01'),
(322, '邱高长青', '511524199204180024', '女', '1992-04-18', '2013-07-01'),
(309, '冉光俊', '510103197309155710', '男', '1973-09-15', '1994-07-01'),
(327, '田原', '513030199904070047', '女', '1999-04-07', '2023-07-14'),
(303, '汪琳', '510103197108310040', '女', '1971-08-31', '1992-08-01'),
(345, '杨钰婕', '511102199707145925', '女', '1997-07-14', '2019-08-01'),
(344, '张福祥', '230621199504160058', '男', '1995-04-16', '2017-08-01'),
(339, '刘嘉', '51010419790927236X', '女', '1979-09-27', '2000-08-01'),
(343, '唐国晋', '511381199708288596', '男', '1997-08-28', '2021-07-20'),
(341, '胡艺山', '510522198903201295', '男', '1989-03-20', '2015-07-01'),
(346, '李汶卿', '620503199907198039', '男', '1999-07-19', '2024-07-12'),
(311, '熊静', '510102197005034083', '女', '1970-05-03', '1990-09-01'),
(315, '杨洋', '510106197512164128', '女', '1975-12-16', '1998-08-01'),
(323, '周宏伟', '429006198705292113', '男', '1987-05-29', '2014-06-01'),
(324, '周雪莲', '511323198111206326', '女', '1981-11-20', '2007-07-01'),
(342, '李庆', '510107197706032170', '男', '1977-06-03', '2000-07-01'),
(340, '张磊', '511111198901171715', '男', '1989-01-17', '2013-07-01'),
(389, '徐明扬', NULL, '男', NULL, '2025-06-01'),
(390, '徐明扬', NULL, '男', NULL, '2025-06-01');


-- 1. 插入到新的 employees 表
INSERT INTO employees (id, full_name, id_number, gender, date_of_birth, hire_date)
SELECT new_id, full_name, id_number, gender, date_of_birth, hire_date
FROM temp_employee_import;

-- 2. 填充 ID 映射表
INSERT INTO migration_employee_id_map (old_id, new_id)
SELECT old_id, new_id
FROM temp_employee_import;

-- 删除临时表
DROP TABLE temp_employee_import;